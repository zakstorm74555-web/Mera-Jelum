<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#004D40">
    <title>Ù…ÛŒØ±Ø§ Ø¬ÛÙ„Ù… - ÛÙˆÙ…</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <style>
        :root { --primary: #004D40; --accent: #D4AF37; }
        body { margin: 0; background: #f0f2f5; font-family: 'Segoe UI'; padding-bottom: 100px; overflow-x: hidden; }
        
        /* Header & Ribbon Style */
        .header { background: var(--primary); color: white; padding: 25px 20px; text-align: center; position: relative; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .ribbon { position: absolute; top: 10px; right: -35px; background: #2e7d32; color: white; padding: 5px 40px; transform: rotate(45deg); font-size: 12px; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.3); border: 1px solid var(--accent); }
        
        /* Tasbih Counter Style */
        .tasbih-container { background: white; margin: 15px; border-radius: 25px; padding: 20px; text-align: center; border-bottom: 5px solid var(--primary); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .counter-display { font-size: 4rem; font-weight: bold; color: var(--primary); margin: 10px 0; font-family: 'Courier New', Courier, monospace; }
        .btn-tap { background: var(--primary); color: white; border: none; padding: 20px 60px; border-radius: 50px; font-size: 20px; cursor: pointer; transition: 0.2s; box-shadow: 0 4px 10px rgba(0,77,64,0.3); }
        .btn-tap:active { transform: scale(0.95); }
        .btn-reset { background: #e57373; color: white; border: none; padding: 8px 20px; border-radius: 10px; margin-top: 15px; cursor: pointer; }

        .prayer-timer { background: white; margin: 15px; border-radius: 20px; padding: 20px; text-align: center; border: 2px solid var(--accent); position: relative; overflow: hidden; }
        .ramadan-bg-img { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; opacity: 0.1; z-index: 0; pointer-events: none; }
        .timer-content { position: relative; z-index: 1; }

        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: white; display: flex; justify-content: space-around; padding: 15px 0; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); z-index: 100; }
        .nav-item { text-decoration: none; color: #666; font-size: 14px; text-align: center; }
        .nav-item.active { color: var(--primary); font-weight: bold; }
    </style>
</head>
<body>

    <div class="header">
        <div class="ribbon">Ø±Ù…Ø¶Ø§Ù† Ù…Ø¨Ø§Ø±Ú©</div>
        <img src="icon.png" width="35" style="vertical-align: middle; margin-left: 10px;">
        <span style="font-size: 24px; font-weight: bold;">Ù…ÛŒØ±Ø§ Ø¬ÛÙ„Ù…</span>
    </div>

    <div class="prayer-timer">
        <img src="https://www.transparentpng.com/download/ramadan/ramadan-hanging-lamps-png-7.png" class="ramadan-bg-img">
        <div class="timer-content">
            <h2 id="clock" style="margin: 0; color: var(--primary);">00:00:00</h2>
            <div style="display: flex; justify-content: space-around; margin-top: 15px;">
                <div><small>Ø³Ø­Ø± (Ø®ØªÙ…)</small><br><b id="s-time" style="color: #d32f2f;">05:23 AM</b></div>
                <div><small>Ø§ÙØ·Ø§Ø± (Ø´Ø±ÙˆØ¹)</small><br><b id="i-time" style="color: #2e7d32;">06:00 PM</b></div>
            </div>
        </div>
    </div>

    <div class="tasbih-container">
        <div style="color: #666; font-size: 14px;">ØªØ³Ø¨ÛŒØ­ Ú©Ø§Ø¤Ù†Ù¹Ø±</div>
        <div id="counter" class="counter-display">0</div>
        <button class="btn-tap" onclick="countUp()">Ù¹ÛŒÙ¾ Ú©Ø±ÛŒÚº</button><br>
        <button class="btn-reset" onclick="resetCount()">Ø±ÛŒ Ø³ÛŒÙ¹</button>
    </div>

    <div id="mandi-list"></div>

    <audio id="audioAzaan" src="azaan.mp3"></audio>
    <audio id="audioSehri" src="sehri.mp3"></audio>
    <audio id="audioAftari" src="aftari.mp3"></audio>

    <nav class="bottom-nav">
        <a href="home.html" class="nav-item active">ğŸ <br>ÛÙˆÙ…</a>
        <a href="shops.html" class="nav-item">ğŸ›’<br>Ø¯Ú©Ø§Ù†ÛŒÚº</a>
        <a href="ratelist.html" class="nav-item">ğŸ§¾<br>Ø±ÛŒÙ¹ Ù„Ø³Ù¹</a>
        <a href="profile.html" class="nav-item">ğŸ‘¤<br>Ù¾Ø±ÙˆÙØ§Ø¦Ù„</a>
    </nav>

    <script>
        // Notification Permission Logic
        window.onload = function() {
            if ("Notification" in window) {
                if (Notification.permission !== "granted") {
                    Notification.requestPermission().then(permission => {
                        if (permission === "granted") {
                            console.log("Notification permission granted.");
                        }
                    });
                }
            }
        };

        // Tasbih Logic
        let count = localStorage.getItem('tasbihCount') || 0;
        document.getElementById('counter').innerText = count;

        function countUp() {
            count++;
            document.getElementById('counter').innerText = count;
            localStorage.setItem('tasbihCount', count);
            if (navigator.vibrate) navigator.vibrate(50); // Tap feel
        }

        function resetCount() {
            if(confirm("Ú©ÛŒØ§ Ø¢Ù¾ Ú©Ø§Ø¤Ù†Ù¹Ø± Ø±ÛŒ Ø³ÛŒÙ¹ Ú©Ø±Ù†Ø§ Ú†Ø§ÛØªÛ’ ÛÛŒÚºØŸ")) {
                count = 0;
                document.getElementById('counter').innerText = count;
                localStorage.setItem('tasbihCount', 0);
            }
        }

        // Firebase & Clock Logic
        const firebaseConfig = {
            apiKey: "AIzaSyDey-KaC_Ty-dqijuQMWeQjtUx3eaaXc6k",
            authDomain: "mera-jehlum.firebaseapp.com",
            databaseURL: "https://mera-jehlum-default-rtdb.firebaseio.com",
            projectId: "mera-jehlum",
            storageBucket: "mera-jehlum.firebasestorage.app",
            messagingSenderId: "1093409222171",
            appId: "1:1093409222171:web:e9c1d2113c6bb7ae2952be"
        };
        firebase.initializeApp(firebaseConfig);

        function updateClock() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('en-US', { hour12: true, hour: '2-digit', minute: '2-digit' });
            document.getElementById('clock').innerText = now.toLocaleTimeString();

            const sehri = document.getElementById('s-time').innerText;
            const iftar = document.getElementById('i-time').innerText;

            if (timeStr === sehri && now.getSeconds() === 0) {
                document.getElementById('audioSehri').play();
                new Notification("Ø³Ø­Ø±ÛŒ Ú©Ø§ ÙˆÙ‚Øª Ø®ØªÙ… ÛÙˆ Ú¯ÛŒØ§ ÛÛ’!");
            }
            if (timeStr === iftar && now.getSeconds() === 0) {
                document.getElementById('audioAftari').play();
                document.getElementById('audioAzaan').play();
                new Notification("Ø§ÙØ·Ø§Ø±ÛŒ Ú©Ø§ ÙˆÙ‚Øª ÛÙˆ Ú¯ÛŒØ§ ÛÛ’! Ø¯Ø¹Ø§ ÛŒØ§Ø¯ Ø±Ú©Ú¾ÛŒÚºÛ”");
            }
        }
        setInterval(updateClock, 1000);
    </script>
</body>
</html>
